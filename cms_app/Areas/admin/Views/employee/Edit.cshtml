@{
    ViewBag.Title = "Employee";
    Layout = "~/Views/Shared/_Layout.cshtml";

    System.Data.DataSet ds = new System.Data.DataSet();
    if (ViewData["dsData"] != null)
    {
        ds = ViewData["dsData"] as System.Data.DataSet;
    }
}

<!-- Breadcrumbs-->
<ol class="breadcrumb">
    <li class="breadcrumb-item">
        <a href="@Url.Action("index", "dashboard" , new { area= "admin" })">Dashboard</a>
    </li>
    <li class="breadcrumb-item active">Employee</li>
</ol>

<!-- Page Content -->
<h1>Employee Master</h1>

<!-- Icon Cards-->
<div class="row">
    <div class="col-xl-12 col-sm-12 mb-3">
        <div id="form1" class="card-body">
        @if (ds != null && ds.Tables.Count > 1)
        {
            System.Data.DataRow dr = ds.Tables[0].Rows[0];

                @*<span id="hidId" style="display:none;">@dr["EmployeeId"]</span>*@
            <input type="hidden" id="hidId" value="@dr["EmployeeId"]" />
                @*<input type="hidden" id="hidR" value="@dr["HRRoleCode"]" />*@
                <input type="hidden" id="hidM" value="@dr["MaritalStatus"]" />
                <input type="hidden" id="hidB" value="@dr["BloodGroup"]" />

                <div class="row clearfix">
                    <div class="content-heading">
                        <a href="javascript:void(0)" class="glyphicon-expand"><span>+</span></a>Professional Information
                    </div>
                    <div class="mycontainer col-lg-12">
                        <div class="col-lg-12 form-group form-row"></div>

                        <div class="form-group">
                            <div class="form-row">
                                <div class="col-lg-3 col-md-3 col-sm-12">
                                    <label for="sltCompany">Company<span class="req">*</span></label>
                                    <span>
                                        <select id="sltCompany" class="form-control required" autofocus="autofocus">
                                            <option value="0">Select</option>
                                            @foreach (System.Data.DataRow dr1 in ds.Tables[1].Rows)
                                            {
                                                if (dr["CompanyCode"].ToString() == dr1[0].ToString())
                                                {
                                                    <option value="@dr1[0]" data-child="@dr[2]" selected="selected">@dr1[1]</option>
                                                }
                                                else
                                                {
                                                    <option value="@dr1[0]" data-child="@dr[2]">@dr1[1]</option>
                                                }
                                            }
                                        </select>
                                    </span>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12">
                                    <label for="sltRole">Role</label>
                                    <span>
                                        <select id="sltRole" class="form-control">
                                            @foreach (System.Data.DataRow dr1 in ds.Tables[2].Rows)
                                            {
                                                if (dr["HRRoleCode"].ToString() == dr1[0].ToString())
                                                {
                                                    <option value="@dr1[0]" selected="selected">@dr1[2]</option>
                                                }
                                                else
                                                {
                                                    <option value="@dr1[0]">@dr1[2]</option>
                                                }
                                            }
                                        </select>
                                    </span>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12">
                                    <label for="txtEmployeeCode">Employee Code</label>
                                    <span><input type="text" id="txtEmployeeCode" class="form-control required" value="@dr["EmployeeCode"]" /></span>
                                </div>
                                <div class="col-lg-3 col-md-3 col-sm-12">
                                    <label for="txtEmployeePassword">Password</label>
                                    <span><input type="text" id="txtEmployeePassword" class="form-control" value="@dr["AuthPassword"]" /></span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="form-row">
                                <div class="col-md-3">
                                    <label for="inputEmail">Email Id</label>
                                    <input type="email" id="inputEmail" class="form-control" placeholder="Email Id" value="@dr["EmailID"]" />
                                </div>
                                <div class="col-md-3">
                                    <label for="inputPhone">Phone No</label>
                                    <input type="text" id="inputPhone" class="form-control" placeholder="Phone No" value="@dr["ContactNo"]" />
                                </div>
                                <div class="col-md-3">
                                    <label for="inputDOJ">DOJ</label>
                                    <input type="date" id="inputDOJ" class="form-control" />
                                </div>
                                <div class="col-md-3">
                                    <label for="inputDept">Department Name</label>
                                    <span>
                                        <select id="inputDept" class="form-control">
                                            <option value="0">Select</option>
                                            @foreach (System.Data.DataRow dr1 in ds.Tables[3].Rows)
                                            {
                                                if (dr["Department"].ToString() == dr1[0].ToString())
                                                {
                                                    <option value="@dr1[0]" selected="selected">@dr1[2]</option>
                                                }
                                                else
                                                {
                                                    <option value="@dr1[0]">@dr1[2]</option>
                                                }
                                            }
                                        </select>
                                    </span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <hr>

                <div class="row clearfix">
                    <div class="content-heading">
                        <a href="javascript:void(0)" class="glyphicon-expand"><span>+</span></a>Personal Information
                    </div>
                    <div class="mycontainer col-lg-12">
                        <div class="col-lg-12 form-group form-row"></div>
                        <div class="row">
                            <div class="col-xl-6 col-sm-6">
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <div class="form-row">
                                            <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                                <div class="form-label-group">
                                                    <input type="text" id="inputEmployeeName" class="form-control required" placeholder="Employee Name" value="@dr["EmployeeName"]" />
                                                    <label for="inputEmployeeName">Employee Name</label>
                                                </div>
                                            </div>
                                            <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                                <div class="form-label-group">
                                                    <input type="text" id="inputFatherName" class="form-control" placeholder="Father Name" value="@dr["FatherName"]" />
                                                    <label for="inputFatherName">Father Name</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="form-row">
                                            <div class="col-xl-12 col-sm-12 col-lg-12 col-md-12 col-sm-12">
                                                <div class="form-label-group">
                                                    <input type="text" id="inputAddress" class="form-control" placeholder="Address" value="@dr["ContactNo"]" />
                                                    <label for="inputAddress">Address</label>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="form-row">
                                            <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                                <label for="inputDOB">DOB</label>
                                                <input type="date" id="inputDOB" class="form-control" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="form-row">
                                            <div class="col-md-3">
                                                <div class="checkbox">
                                                    <label>
                                                        <input type="checkbox" id="chkActive" value="1" checked="checked" />
                                                        Active
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-xl-6 col-sm-6">
                                <div class="form-group">
                                    <div class="form-row">
                                        <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                            @*<label for="sltMaritalStatus">MaritalStatus</label>*@
                                            <span>
                                                <select id="sltMaritalStatus" class="form-control required">
                                                    <option value="0">Select Marital Status</option>
                                                    <option value="Single">Single</option>
                                                    <option value="Married">Married</option>
                                                    <option value="Divorced">Divorced</option>
                                                    <option value="Widowed">Widowed</option>
                                                </select>
                                            </span>
                                        </div>

                                        <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                            @*<label for="sltBloodGroup">Blood Group</label>*@
                                            <span>
                                                <select id="sltBloodGroup" class="form-control">
                                                    <option value="0">Select Blood Group</option>
                                                    <option value="A+">A+</option>
                                                    <option value="A-">A-</option>
                                                    <option value="B+">B+</option>
                                                    <option value="B-">B-</option>
                                                    <option value="O+">O+</option>
                                                    <option value="O-">O-</option>
                                                    <option value="AB+">AB+</option>
                                                    <option value="AB-">AB-</option>
                                                </select>
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="form-row">
                                        <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                            <div class="form-label-group">
                                                <input type="text" id="inputPANNo" class="form-control" placeholder="PAN No" />
                                                <label for="inputPANNo">PAN No</label>
                                            </div>
                                        </div>
                                        <div class="col-xl-6 col-sm-6 col-lg-6 col-md-6 col-sm-12">
                                            <div class="form-label-group">
                                                <input type="text" id="inputAadharNo" class="form-control" placeholder="Aadhar No" />
                                                <label for="inputAadharNo">Aadhar No</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="form-row">
                                        <div class="col-xl-12 col-sm-12 col-lg-12 col-md-12 col-sm-12">
                                            <div class="form-label-group">
                                                <input type="text" id="inputRemark" class="form-control" placeholder="Remark" />
                                                <label for="inputRemark">Remark</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <hr>

                <div class="form-group">
                    <div class="form-row">
                        <div class="col-md-2">
                            <input id="btnUpdate" type="submit" data-action="UPDATE" value="Update" class="btn rounded-btn btn-block" />
                        </div>
                        <div class="col-md-2">
                            <input id="btnCancel" type="button" value="Cancel" class="btn rounded-btn btn-block" />
                        </div>
                    </div>
                </div>
        }
        </div>
    </div>
</div>

<script type="text/javascript">
    var isshowList = 0;
</script>
<script src="@Url.Content("~/Scripts/masterjs/employee.js")"></script>

<script type="text/javascript">
    $(document).ready(function() {
        //var cid = $('#hidR').val();
        if ($('#hidM').val() != '0')
            $("#sltMaritalStatus").val($('#hidM').val());
        if ($('#hidB').val() != '0')
            $("#sltBloodGroup").val($('#hidB').val());

    });
</script>
@*<script type="text/javascript">
    $(document).ready(function () {
        var cid = $('#hidR').val();
        //var hm = $('#hidM').val();
        //var hb = $('#hidB').val();

        if ($('#hidM').val() != '0')
            $("#sltMaritalStatus").val($('#hidM').val());
        if ($('#hidB').val() != '0')
            $("#sltBloodGroup").val($('#hidB').val());

        $("#sltCompany").change(function () {
            var code = $(this).val();
            $("#sltRole").empty().append('<option value="0">Select Role</option>');
            if (code != '0') {
                var URL = '@Url.Action("FillHierarchy")';
                URL = URL + '?prmCompanyCode=' + code;
                changeDropDown(URL, "#sltRole", cid, 'ROLE');
                $('#hidId').val('');
            }
        });

        $("#sltCompany").change();
        toggelDiv($('.glyphicon-expand:eq(0)'));
        if ($('#sltCompany option').length == 2)
            $('#sltCompany').attr("disabled", "disabled");

        $("#btnUpdate").click(function () {
            if (!isFormValidate('#form1')) {
                alert('Please fill required field.');
                return;
            }

            var empId = $('#hidId').text().trim();
            var companyCode = $('#sltCompany').val();
            var role = $('#sltRole').val();
            var empCode = $('#txtEmployeeCode').val().trim();
            var empPass = $('#txtEmployeePassword').val().trim();
            var empEmail = $('#inputEmail').val().trim();
            var empPhone = $('#inputPhone').val().trim();
            var empDoj = $('#inputDOJ').val().trim();
            var empFirstName = $('#FirstName').val().trim();
            var empMName = $('#MiddleName').val().trim();
            var empLName = $('#LastName').val().trim();
            var empFatherName = $('#FatherName').val().trim();
            var empMotherName = $('#MotherName').val().trim();
            var empDOB = $('#inputDOB').val().trim();
            var empPOB = $('#txtPOB').val().trim();
            var empMaritalStatus = $('#sltMaritalStatus').val();
            var empBlood = $('#sltBloodGroup').val();
            var empPANNo = $('#inputPANNo').val().trim();
            var empPFNo = $('#inputPFNo').val().trim();
            var empPassport = $('#inputPassportNo').val().trim();
            var empDOI = $('#inputDOI').val().trim();
            var empPOI = $('#inputPlaceOfIssue').val().trim();
            var empDOE = $('#inputDOExpiry').val().trim();
            var active = $('#chkActive').prop('checked');
            var act = $(this).attr('data-action');

            var prmdata = {
                prmEmpId: empId, prmCompanyCode: companyCode, prmRole: role, prmEmpCode: empCode, prmEmpPass: empPass, prmEmailId: empEmail,
                prmPhone: empPhone, prmDOJ: empDoj, prmFirstName: empFirstName, prmMiddleName: empMName, prmLastName: empLName, prmFatherName: empFatherName,
                prmMotherName: empMotherName,prmDOB: empDOB, prmPOB: empPOB, prmMaritalStatus: empMaritalStatus, prmBlood: empBlood, prmPANNo: empPANNo,
                prmPFNo: empPFNo, prmPassport: empPassport, prmDOI: empDOI, prmPOI: empPOI, prmDOE: empDOE,prmActive: active, prmAction: act
            };

            $.ajax({
                type: "POST",
                url: sessionurl,
                dataType: "json",
                success: function (data) {
                    if (data == "Yes") {
                        saveMasterDataForm(saveurl, prmdata, listurl);
                    } else {
                        window.location.href = data;
                        // session out here. for redirect to login
                    }
                }
            });
        });
    });
</script>*@
